<%- include('../partials/adminHeader.ejs') %>
<style>
  .preview-image {
    max-width: 200px;
    max-height: 200px;
  }
</style>

  <body class="admin-body">
    <%- include('../partials/adminNavbar.ejs') %>
      <%- include('../partials/adminSidebar.ejs') %>
        <section class="conatiner ">
          <div class="row">
            <div class="card form-card ms-auto">
              <h4 class="text-center mt-4  text-secondary ">EDITPRODUCT</h4>
              <div class="card-body">

                <form action="/admin/editProduct/<%= product._id %>" id="form" enctype="multipart/form-data"
                  method="post">

                  <div class="d-flex mb-2">
                    <div class="form-outline input-control w-50">
                      <label class="form-label">Product Name </label>
                      <input type="text" class="form-control form-control-lg " id="productName" name="productName"
                        value="<%=product.productName %>" />
                    </div>
                    <div class="form-outline input-control w-50">
                      <label class="form-label">Brand </label>
                      <input type="text" class="form-control form-control-lg text-small  " id="brand" name="brand"
                        value="<%= product.brand %>" />
                    </div>
                  </div>

                  <div class="mb-2">
                    <label for="exampleFormControlTextarea1" class="form-label ">Description</label>
                    <input class="form-control" value="<%= product.description %>" id="highlights"
                      name="description"></input>
                  </div>



                  <div class="mb-2">
                    <span>Category</span><br>
                    <select class="btn btn-outline-light text-black my-2" id="categoryId" name="category"
                      value="<%category.categoryName %>">

                      <% if(category.length>0){ %>
                        <% category.forEach(items=>{ %>

                          <option value="<%= items._id %>" class="text-black"
                            <%=items._id.toString()==product.category.toString()? "selected" :" " %> ><%= items.categoryName %></option>
                  <% }) %>
                  <% } %>
                  </select>`
                </div>

                <div class=" form-outline input-control mb-2 w-50 ">
                  <label class=" form-label">Price </label>
                            <input type="number" id="price" value="<%= product.price %>" name="price"
                              class="form-control form-control-sm w-50 " />
                  </div>
                  <div class="form-outline input-control mb-2 ">
                    <label class="form-label"> Offer(in %) </label>
                    <input type="number" name="offer" value="<%= product.offer %>"
                      class="form-control form-control-sm w-50 " />
                  </div>

                  <div class="form-outline input-control mb-2 w-50">
                    <label class="form-label"> color </label>
                    <input type="text" id="colour" value="<%= product.color %>"
                      class="form-control form-control-sm w-50 " name="color" />
                  </div>

                  <div class="input-group row mb-2">
                    <label class="form-label">Images of the Product</label>
                    <div class="col-12">
                      <% if (product.images[0]) { %>
                        <img class="productImage mb-2" src="/<%= product.images[0] %>" id="viewimage1">
                        <a href="/admin/deleteSingleImage/<%= product._id %>/0" class="btn">
                          <img class="ms-3" src="https://img.icons8.com/material-rounded/25/null/filled-trash.png" />
                          <span>Delete</span>
                        </a>
                      <% } %>
                    
                      <input type="file" accept="image/png,image/webp,image/jpg,image/jpeg" class="form-control form-control-sm my-2 ms-3 w-50" name="image1" id="image1" onchange="previewImage(1)">
                      <img class="preview-image mb-2" id="previewImage1" />
                    </div>
                    
                    <div class="col-12">
                      <% if (product.images[1]) { %>
                        <img class="productImage mb-2" src="/<%= product.images[1] %>" id="viewimage2">
                        <a href="/admin/deleteSingleImage/<%= product._id %>/1" class="btn">
                          <img class="ms-3" src="https://img.icons8.com/material-rounded/25/null/filled-trash.png" />
                          <span>Delete</span>
                        </a>
                      <% } %>
                    
                      <input type="file" accept="image/png,image/webp,image/jpg,image/jpeg" class="form-control form-control-sm my-2 ms-3 w-50" name="image2" id="image2" onchange="previewImage(2)">
                      <img class="preview-image mb-2" id="previewImage2" />
                    </div>
                    
                    <div class="col-12">
                      <% if (product.images[2]) { %>
                        <img class="productImage mb-2" src="/<%= product.images[2] %>" id="viewimage3">
                        <a href="/admin/deleteSingleImage/<%= product._id %>/2" class="btn">
                          <img class="ms-3" src="https://img.icons8.com/material-rounded/25/null/filled-trash.png" />
                          <span>Delete</span>
                        </a>
                      <% } %>
                    
                      <input type="file" accept="image/png,image/webp,image/jpg,image/jpeg" class="form-control form-control-sm my-2 ms-3 w-50" name="image3" id="image3" onchange="previewImage(3)">
                      <img class="preview-image mb-2" id="previewImage3" />
                    </div>


                    <div class="mb-2 w-50">
                      <label class="form-label ">Total Stock</label>
                      <input type="text" value="<%= product.totalStock %>" class="form-control form-control-sm w-50 "
                        id="totalStock" name="totalStock" />
                    </div>
                    <div class="row mt-3">
                      <div class="col-4">
                        <button class="btn btn-outline-success" id="edit" data-url="" type="submit">Save
                          Changes</button>
                      </div>
                      <div class="col-4">
                        <a href="/admin/products" class="btn btn-outline-primary">Cancel</a>
                      </div>
                    </div>

                </form>
              </div>
            </div>
          </div>
        </section>
        <script>
        </script>
        <script src="/scripts/adminScript.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
          crossorigin="anonymous"></script>
          <script>
            function previewImage(imageNumber) {
              const fileInput = document.getElementById(`image${imageNumber}`);
              const previewImage = document.getElementById(`previewImage${imageNumber}`);
          
              if (fileInput.files && fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                  previewImage.src = e.target.result;
                };
                reader.readAsDataURL(fileInput.files[0]);
              } else {
                previewImage.src = "";
              }
            }
          </script>
          
  </body>

  </html>